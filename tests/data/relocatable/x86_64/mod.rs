use byteorder::LittleEndian;
use elf_utils::Elf64;
use elf_utils::ElfArch;
use elf_utils::ElfABI;
use elf_utils::ElfHdrData;
use elf_utils::ElfKind;
use elf_utils::ElfTable;
use elf_utils::dynamic::DynamicEntData;
use elf_utils::note::NoteData;
use elf_utils::prog_hdr::ProgHdrData;
use elf_utils::prog_hdr::Segment;
use elf_utils::reloc::x86_64::X86_64Reloc;
use elf_utils::section_hdr::SectionHdrData;
use elf_utils::section_hdr::SectionPos;
use elf_utils::section_hdr::SymsStrs;
use elf_utils::symtab::SymBase;
use elf_utils::symtab::SymBind;
use elf_utils::symtab::SymData;
use elf_utils::symtab::SymKind;
use std::marker::PhantomData;

pub const PATH: &'static str = "tests/data/relocatable/x86_64/crt1.o";

const NUM_SECTION_HDRS: usize = 26;

pub const SECTION_HDR_CONTENTS_BARE: [SectionHdrData<Elf64, u32, u32, u32, u32,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>>;
                                      NUM_SECTION_HDRS] = [
    SectionHdrData::Null,
    SectionHdrData::ProgBits { name: 1, addr: 0, align: 16,
                               data: SectionPos { offset: 0x40, size: 0x28c },
                               alloc: true, write: false, exec: true },
    SectionHdrData::Rela { name: 7, addr: 0, align: 8,
                           relas: SectionPos { offset: 0x2d0, size: 0x258 },
                           symtab: 23, target: 1, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: 18, addr: 0, align: 1,
                               data: SectionPos { offset: 0x528, size: 0x230 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: 27, addr: 0, align: 1,
                               data: SectionPos { offset: 0x758, size: 0x1 },
                               alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: 42, addr: 0, align: 8,
                               data: SectionPos { offset: 0x760, size: 0x8 },
                               alloc: true, write: true, exec: false },
    SectionHdrData::Rela { name: 48, addr: 0, align: 8,
                           relas: SectionPos { offset: 0x768, size: 0x18 },
                           symtab: 23, target: 5, alloc: false, write: false,
                           exec: false },
    SectionHdrData::Nobits { name: 59, addr: 0, align: 8,
                             offset: 0x780, size: 0x8, alloc: true,
                             write: true, exec: false },
    SectionHdrData::ProgBits { name: 64, addr: 0, align: 1,
                               data: SectionPos { offset: 0x780, size: 0x513 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: 75, addr: 0, align: 1,
                               data: SectionPos { offset: 0xc93, size: 0x1cd },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: 89, addr: 0, align: 1,
                               data: SectionPos { offset: 0xe60, size: 0x613 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: 101, addr: 0, align: 8,
                           relas: SectionPos { offset: 0x1478, size: 0xbe8 },
                           symtab: 23, target: 10, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: 118, addr: 0, align: 1,
                               data: SectionPos { offset: 0x2060, size: 0x70 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: 132, addr: 0, align: 1,
                               data: SectionPos { offset: 0x20d0, size: 0x2d3 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: 143, addr: 0, align: 8,
                               data: SectionPos { offset: 0x23a8, size: 0xb0 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: 156, addr: 0, align: 8,
                           relas: SectionPos { offset: 0x2458, size: 0x90 },
                           symtab: 23, target: 14, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: 174, addr: 0, align: 1,
                               data: SectionPos { offset: 0x24e8, size: 0x404 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: 186, addr: 0, align: 8,
                           relas: SectionPos { offset: 0x28f0, size: 0x18 },
                           symtab: 23, target: 16, alloc: false, write: false,
                          exec: false },
    SectionHdrData::Unknown { name: 203, tag: 0x6fff4c03, addr: 0,
                              align: 1, offset: 0x2908, size: 0xa, ent_size: 0,
                              link: 0, info: 0, flags: 0x80000000 },
    SectionHdrData::Unknown { name: 217, tag: 0x11, addr: 0,
                              align: 4, offset: 0x2914, size: 0x8, ent_size: 4,
                              link: 23, info: 14, flags: 0 },
    SectionHdrData::Note { name: 224, addr: 0, align: 4,
                           note: SectionPos { offset: 0x291c, size: 0x18 },
                           alloc: true, write: false, exec: false },
    SectionHdrData::Note { name: 224, addr: 0, align: 4,
                           note: SectionPos { offset: 0x2934, size: 0x30 },
                           alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: 234, addr: 0, align: 1,
                               data: SectionPos { offset: 0x2964, size: 0x0 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Symtab { name: 250, addr: 0, align: 8,
                             syms: SectionPos { offset: 0x2968, size: 0x3a8 },
                             strtab: 25, local_end: 21,
                             alloc: false, write: false, exec: false },
    SectionHdrData::Strtab { name: 258, addr: 0, align: 1,
                             strs: SectionPos { offset: 0x2d10, size: 0x114 } },
    SectionHdrData::Strtab { name: 268, addr: 0, align: 1,
                             strs: SectionPos { offset: 0x2e24, size: 0x114 } }
];

pub const SECTION_HDR_CONTENTS_STRS: [SectionHdrData<Elf64, &'static str,
                                                     u32, u32, u32,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>,
                                                     SectionPos<u64>>;
                                      NUM_SECTION_HDRS] = [
    SectionHdrData::Null,
    SectionHdrData::ProgBits { name: ".text", addr: 0, align: 16,
                               data: SectionPos { offset: 0x40, size: 0x28c },
                               alloc: true, write: false, exec: true },
    SectionHdrData::Rela { name: ".rela.text", addr: 0, align: 8,
                           relas: SectionPos { offset: 0x2d0, size: 0x258 },
                           symtab: 23, target: 1, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: ".comment", addr: 0, align: 1,
                               data: SectionPos { offset: 0x528, size: 0x230 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".rodata.str1.1", addr: 0, align: 1,
                               data: SectionPos { offset: 0x758, size: 0x1 },
                               alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".data", addr: 0, align: 8,
                               data: SectionPos { offset: 0x760, size: 0x8 },
                               alloc: true, write: true, exec: false },
    SectionHdrData::Rela { name: ".rela.data", addr: 0, align: 8,
                           relas: SectionPos { offset: 0x768, size: 0x18 },
                           symtab: 23, target: 5, alloc: false, write: false,
                           exec: false },
    SectionHdrData::Nobits { name: ".bss", addr: 0, align: 8,
                             offset: 0x780, size: 0x8, alloc: true,
                             write: true, exec: false },
    SectionHdrData::ProgBits { name: ".debug_loc", addr: 0, align: 1,
                               data: SectionPos { offset: 0x780, size: 0x513 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_abbrev", addr: 0, align: 1,
                               data: SectionPos { offset: 0xc93, size: 0x1cd },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_info", addr: 0, align: 1,
                               data: SectionPos { offset: 0xe60, size: 0x613 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rela.debug_info", addr: 0, align: 8,
                           relas: SectionPos { offset: 0x1478, size: 0xbe8 },
                           symtab: 23, target: 10, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: ".debug_ranges", addr: 0, align: 1,
                               data: SectionPos { offset: 0x2060, size: 0x70 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_str", addr: 0, align: 1,
                               data: SectionPos { offset: 0x20d0, size: 0x2d3 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_frame", addr: 0, align: 8,
                               data: SectionPos { offset: 0x23a8, size: 0xb0 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rela.debug_frame", addr: 0, align: 8,
                           relas: SectionPos { offset: 0x2458, size: 0x90 },
                           symtab: 23, target: 14, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: ".debug_line", addr: 0, align: 1,
                               data: SectionPos { offset: 0x24e8, size: 0x404 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rela.debug_line", addr: 0, align: 8,
                           relas: SectionPos { offset: 0x28f0, size: 0x18 },
                           symtab: 23, target: 16, alloc: false, write: false,
                           exec: false },
    SectionHdrData::Unknown { name: ".llvm_addrsig", tag: 0x6fff4c03, addr: 0,
                              align: 1, offset: 0x2908, size: 0xa, ent_size: 0,
                              link: 0, info: 0, flags: 0x80000000 },
    SectionHdrData::Unknown { name: ".group", tag: 0x11, addr: 0,
                              align: 4, offset: 0x2914, size: 0x8, ent_size: 4,
                              link: 23, info: 14, flags: 0 },
    SectionHdrData::Note { name: ".note.tag", addr: 0, align: 4,
                           note: SectionPos { offset: 0x291c, size: 0x18 },
                           alloc: true, write: false, exec: false },
    SectionHdrData::Note { name: ".note.tag", addr: 0, align: 4,
                           note: SectionPos { offset: 0x2934, size: 0x30 },
                           alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".note.GNU-stack", addr: 0, align: 1,
                               data: SectionPos { offset: 0x2964, size: 0x0 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Symtab { name: ".symtab", addr: 0, align: 8,
                             syms: SectionPos { offset: 0x2968, size: 0x3a8 },
                             strtab: 25, local_end: 21,
                             alloc: false, write: false, exec: false },
    SectionHdrData::Strtab { name: ".shstrtab", addr: 0, align: 1,
                             strs: SectionPos { offset: 0x2d10, size: 0x114 } },
    SectionHdrData::Strtab { name: ".strtab", addr: 0, align: 1,
                             strs: SectionPos { offset: 0x2e24, size: 0x114 } }
];

pub const HEADER_DATA: ElfHdrData<LittleEndian, Elf64, ElfTable<Elf64>,
                                  ElfTable<Elf64>, u16> =
    ElfHdrData {
        byteorder: PhantomData, abi: ElfABI::FreeBSD, abi_version: 0,
        kind: ElfKind::Relocatable, arch: ElfArch::X86_64,
        entry: 0, flags: 0, section_hdr_strtab: 24, prog_hdrs: None,
        section_hdrs: ElfTable { offset: 12088, num_ents: 26 }
    };

const NUM_NOTES1: usize = 1;
const NUM_NOTES2: usize = 2;

const NOTE_1_NAME: [u8; 8] = [
    0x46, 0x72, 0x65, 0x65, 0x42, 0x53, 0x44, 0x00
];
const NOTE_1_DESC: [u8; 4] = [
    0xa2, 0xd6, 0x13, 0x00
];
const NOTE_2_NAME: [u8; 8] = [
    0x46, 0x72, 0x65, 0x65, 0x42, 0x53, 0x44, 0x00
];
const NOTE_2_DESC: [u8; 4] = [
    0x00, 0x00, 0x00, 0x00
];
const NOTE_3_NAME: [u8; 8] = [
    0x46, 0x72, 0x65, 0x65, 0x42, 0x53, 0x44, 0x00
];
const NOTE_3_DESC: [u8; 4] = [
    0x00, 0x00, 0x00, 0x00
];

pub const NOTES1_CONTENTS: [NoteData<'static>; NUM_NOTES1] = [
    NoteData { kind: 1, name: &NOTE_1_NAME, desc: &NOTE_1_DESC },
];

pub const NOTES2_CONTENTS: [NoteData<'static>; NUM_NOTES2] = [
    NoteData { kind: 4, name: &NOTE_2_NAME, desc: &NOTE_2_DESC },
    NoteData { kind: 2, name: &NOTE_3_NAME, desc: &NOTE_3_DESC },
];

const SHSTRTAB_NUM_STRS: usize = 25;

pub const SHSTRTAB_CONTENTS: [(&'static str, usize); SHSTRTAB_NUM_STRS] = [
    ("", 0),
    (".text", 1),
    (".rela.text", 7),
    (".comment", 18),
    (".rodata.str1.1", 27),
    (".data", 42),
    (".rela.data", 48),
    (".bss", 59),
    (".debug_loc", 64),
    (".debug_abbrev", 75),
    (".debug_info", 89),
    (".rela.debug_info", 101),
    (".debug_ranges", 118),
    (".debug_str", 132),
    (".debug_frame", 143),
    (".rela.debug_frame", 156),
    (".debug_line", 174),
    (".rela.debug_line", 186),
    (".llvm_addrsig", 203),
    (".group", 217),
    (".note.tag", 224),
    (".note.GNU-stack", 234),
    (".symtab", 250),
    (".shstrtab", 258),
    (".strtab", 268),
];

const STRTAB_NUM_STRS: usize = 23;

pub const STRTAB_CONTENTS: [(&'static str, usize); STRTAB_NUM_STRS] = [
    ("", 0),
    ("crt1_c.c", 1),
    ("finalizer", 10),
    ("handle_static_init", 20),
    (".freebsd.noteG", 39),
    ("_DYNAMIC", 54),
    ("__fini_array_end", 63),
    ("__fini_array_start", 80),
    ("__init_array_end", 99),
    ("__init_array_start", 116),
    ("__preinit_array_end", 135),
    ("__preinit_array_start", 155),
    ("__progname", 177),
    ("__rela_iplt_end", 188),
    ("__rela_iplt_start", 204),
    ("_fini", 222),
    ("_init", 228),
    ("_init_tls", 234),
    ("_start", 244),
    ("atexit", 251),
    ("environ", 258),
    ("exit", 266),
    ("main", 271),
];

const SYMTAB_NUM_SYMS: usize = 39;

pub const SYMTAB_CONTENTS: [SymData<&'static str, u16, Elf64>;
                            SYMTAB_NUM_SYMS] = [
    SymData { name: None, value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Local, section: SymBase::Undef },
    SymData { name: Some("crt1_c.c"), value: 0, size: 0,
              kind: SymKind::File, bind: SymBind::Local,
              section: SymBase::Absolute },
    SymData { name: Some("finalizer"), value: 560, size: 90,
              kind: SymKind::Function, bind: SymBind::Local,
              section: SymBase::Index(1) },
    SymData { name: Some("handle_static_init"), value: 272, size: 282,
              kind: SymKind::Function, bind: SymBind::Local,
              section: SymBase::Index(1) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(1) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(5) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(7) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(8) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(9) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(10) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(12) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(14) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(16) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(18) },
    SymData { name: Some(".freebsd.noteG"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Local,
              section: SymBase::Index(19) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(19) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(20) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(3) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(4) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(13) },
    SymData { name: None, value: 0, size: 0, kind: SymKind::Section,
              bind: SymBind::Local, section: SymBase::Index(21) },
    SymData { name: Some("_DYNAMIC"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Weak,
              section: SymBase::Undef },
    SymData { name: Some("__fini_array_end"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__fini_array_start"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__init_array_end"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__init_array_start"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__preinit_array_end"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__preinit_array_start"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("__progname"), value: 0, size: 8,
              kind: SymKind::Object, bind: SymBind::Global,
              section: SymBase::Index(5) },
    SymData { name: Some("__rela_iplt_end"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Weak,
              section: SymBase::Undef },
    SymData { name: Some("__rela_iplt_start"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Weak,
              section: SymBase::Undef },
    SymData { name: Some("_fini"), value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Global, section: SymBase::Undef },
    SymData { name: Some("_init"), value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Global, section: SymBase::Undef },
    SymData { name: Some("_init_tls"), value: 0, size: 0,
              kind: SymKind::None, bind: SymBind::Global,
              section: SymBase::Undef },
    SymData { name: Some("_start"), value: 0, size: 262,
              kind: SymKind::Function, bind: SymBind::Global,
              section: SymBase::Index(1) },
    SymData { name: Some("atexit"), value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Global, section: SymBase::Undef },
    SymData { name: Some("environ"), value: 0, size: 8,
              kind: SymKind::Object, bind: SymBind::Global,
              section: SymBase::Index(7) },
    SymData { name: Some("exit"), value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Global, section: SymBase::Undef },
    SymData { name: Some("main"), value: 0, size: 0, kind: SymKind::None,
              bind: SymBind::Global, section: SymBase::Undef },
];

const RELA_TEXT_FRAME_NUM_RELS: usize = 25;

const RELA_TEXT_FRAME_RELS_CONTENTS_X86: [X86_64Reloc<SymData<&'static str,
                                                              u16, Elf64>>;
                                          RELA_TEXT_FRAME_NUM_RELS] = [
    X86_64Reloc::PC32 { offset: 0x22, addend: -5,
                        sym: SymData { name: Some("environ"), value: 0, size: 8,
                                       kind: SymKind::Object,
                                       bind: SymBind::Global,
                                       section: SymBase::Index(7) } },
    X86_64Reloc::PC32 { offset: 0x2c, addend: -4,
                        sym: SymData { name: Some("environ"), value: 0, size: 8,
                                       kind: SymKind::Object,
                                       bind: SymBind::Global,
                                       section: SymBase::Index(7) } },
    X86_64Reloc::Abs32 { offset: 0x42, addend: 0,
                         sym: SymData { name: Some("_DYNAMIC"),
                                        value: 0, size: 0,
                                        kind: SymKind::None,
                                        bind: SymBind::Weak,
                                        section: SymBase::Undef } },
    X86_64Reloc::PLTRel { offset: 0x4f, addend: -4,
                          sym: SymData { name: Some("atexit"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::PC32 { offset: 0x63, addend: -4,
                        sym: SymData { name: Some("__progname"),
                                       value: 0, size: 8,
                                       kind: SymKind::Object,
                                       bind: SymBind::Global,
                                       section: SymBase::Index(5) } },
    X86_64Reloc::Abs32 { offset: 0x7a, addend: 0,
                        sym: SymData { name: Some("__rela_iplt_end"),
                                       value: 0, size: 0, kind: SymKind::None,
                                       bind: SymBind::Weak,
                                       section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x80, addend: 0,
                         sym: SymData { name: Some("__rela_iplt_start"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Weak,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0xca, addend: 0,
                         sym: SymData { name: Some("__rela_iplt_end"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Weak,
                                        section: SymBase::Undef } },
    X86_64Reloc::PLTRel { offset: 0xdf, addend: -4,
                          sym: SymData { name: Some("_init_tls"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::PLTRel { offset: 0xfb, addend: -4,
                          sym: SymData { name: Some("main"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::PLTRel { offset: 0x102, addend: -4,
                          sym: SymData { name: Some("exit"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x12a, addend: 0,
                         sym: SymData { name: Some("_DYNAMIC"),
                                        value: 0, size: 0,
                                        kind: SymKind::None,
                                        bind: SymBind::Weak,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x13b, addend: 0x230,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::PLTRel { offset: 0x140, addend: -4,
                          sym: SymData { name: Some("atexit"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x145, addend: 0,
                         sym: SymData { name: Some("__preinit_array_start"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x14a, addend: 0,
                         sym: SymData { name: Some("__preinit_array_end"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32Signed {
        offset: 0x192, addend: 0,
        sym: SymData { name: Some("__preinit_array_start"),
                       value: 0, size: 0, kind: SymKind::None,
                       bind: SymBind::Global, section: SymBase::Undef }
    },
    X86_64Reloc::PLTRel { offset: 0x1ac, addend: -4,
                          sym: SymData { name: Some("_init"), value: 0, size: 0,
                                         kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x1b1, addend: 0,
                         sym: SymData { name: Some("__init_array_start"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x1b7, addend: 0,
                         sym: SymData { name: Some("__init_array_end"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32Signed {
        offset: 0x202, addend: 0,
        sym: SymData { name: Some("__init_array_start"),
                       value: 0, size: 0, kind: SymKind::None,
                       bind: SymBind::Global, section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x237, addend: 0,
                         sym: SymData { name: Some("__fini_array_start"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::Abs32 { offset: 0x23c, addend: 0,
                         sym: SymData { name: Some("__fini_array_end"),
                                        value: 0, size: 0, kind: SymKind::None,
                                        bind: SymBind::Global,
                                        section: SymBase::Undef } },
    X86_64Reloc::PLTRel { offset: 0x25e, addend: -4,
                          sym: SymData { name: Some("_fini"),
                                         value: 0, size: 0, kind: SymKind::None,
                                         bind: SymBind::Global,
                                         section: SymBase::Undef } },
    X86_64Reloc::Abs32Signed {
        offset: 0x279, addend: -8,
        sym: SymData { name: Some("__fini_array_start"),
                       value: 0, size: 0, kind: SymKind::None,
                       bind: SymBind::Global, section: SymBase::Undef } },
];

const RELA_DATA_NUM_RELS: usize = 1;

const RELA_DATA_RELS_CONTENTS_X86: [X86_64Reloc<SymData<&'static str, u16,
                                                        Elf64>>;
                                    RELA_DATA_NUM_RELS] = [
    X86_64Reloc::Abs64 { offset: 0, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(4) } }
];

const RELA_DEBUG_INFO_NUM_RELS: usize = 127;

const RELA_DEBUG_INFO_RELS_CONTENTS_X86: [X86_64Reloc<SymData<&'static str,
                                                              u16, Elf64>>;
                                          RELA_DEBUG_INFO_NUM_RELS] = [
    X86_64Reloc::Abs32 { offset: 0x6, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(9) } },
    X86_64Reloc::Abs32 { offset: 0xc, addend: 0x144,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x12, addend: 0x1e0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x16, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(16) } },
    X86_64Reloc::Abs32 { offset: 0x1a, addend: 0x26a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x1e, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x2b, addend: 0x6f,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x37, addend: 0,
                         sym: SymData { name: Some("__progname"),
                                        value: 0, size: 8,
                                        kind: SymKind::Object,
                                        bind: SymBind::Global,
                                        section: SymBase::Index(5) } },
    X86_64Reloc::Abs32 { offset: 0x4a, addend: 0xe8,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x51, addend: 0x254,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x5d, addend: 0,
                         sym: SymData { name: Some("environ"),
                                        value: 0, size: 8,
                                        kind: SymKind::Object,
                                        bind: SymBind::Global,
                                        section: SymBase::Index(7) } },
    X86_64Reloc::Abs32 { offset: 0x75, addend: 0x244,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x86, addend: 0xed,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x91, addend: 0x21d,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x9c, addend: 0x1a6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xa7, addend: 0x212,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xae, addend: 0x35,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xd8, addend: 0x1af,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xe3, addend: 0xdd,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xea, addend: 0xf6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0xf5, addend: 0x200,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x100, addend: 0x11c,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x107, addend: 0x16,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x10f, addend: 0x295,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x11a, addend: 0xc1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x125, addend: 0xc6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x130, addend: 0x85,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x13c, addend: 0x9b,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x143, addend: 0x2a7,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x14b, addend: 0x1d1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x165, addend: 0x13b,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x170, addend: 0x7a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x17b, addend: 0x128,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x187, addend: 0x47,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x193, addend: 0x2b7,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1a4, addend: 0x63,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1af, addend: 0x1b8,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1ba, addend: 0x9f,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1c5, addend: 0x131,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1cc, addend: 0x103,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1d4, addend: 0x20a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1df, addend: 0x1d3,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1ef, addend: 0x10c,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x1fb, addend: 0x228,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x203, addend: 0x1d1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x20e, addend: 0x1d3,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x219, addend: 0x2c0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x224, addend: 0x29a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x22f, addend: 0xca,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x23a, addend: 0xa7,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x245, addend: 0x1d5,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x250, addend: 0x264,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x25b, addend: 0x1d9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x273, addend: 0x87,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x27a, addend: 0x4e,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x282, addend: 0x20a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x28d, addend: 0x1c5,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x298, addend: 0x1d3,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x2a4, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x2b2, addend: 0x24d,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x2b9, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x2bd, addend: 0x10,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x2c8, addend: 0x36,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x2cc, addend: 0x25c,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x2d7, addend: 0x98,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x2db, addend: 0xc1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x2e6, addend: 0xbb,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x2ea, addend: 0x295,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x2f5, addend: 0x180,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x2f9, addend: 0xc6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x308, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(12) } },
    X86_64Reloc::Abs32 { offset: 0x310, addend: 0x114,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x319, addend: 0xde,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x322, addend: 0x14a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs64 { offset: 0x335, addend: 0x79,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x345, addend: 0x1a3,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x352, addend: 0x40,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(12) } },
    X86_64Reloc::Abs32 { offset: 0x35a, addend: 0x1c6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x363, addend: 0x1e9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x36c, addend: 0x23f,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x375, addend: 0x262,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x37e, addend: 0x2a9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x387, addend: 0x2cc,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x395, addend: 0x2ef,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x39e, addend: 0x339,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs64 { offset: 0x3ab, addend: 0x89,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x3cb, addend: 0x95,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x3db, addend: 0x285,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs64 { offset: 0x3ee, addend: 0xa8,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x416, addend: 0x53,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x421, addend: 0xc9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x435, addend: 0xe3,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x442, addend: 0xf1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x462, addend: 0xff,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x47f, addend: 0x2cc,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x496, addend: 0x112,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x49d, addend: 0x110,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x4ab, addend: 0x22,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4b2, addend: 0x35c,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x4b6, addend: 0x295,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4c1, addend: 0x392,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x4c5, addend: 0xc1,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4d0, addend: 0x3c9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x4d4, addend: 0xc6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4df, addend: 0x400,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x4e3, addend: 0x1cf,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4ee, addend: 0x239,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x4f9, addend: 0x45e,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x4fd, addend: 0x13,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x50c, addend: 0x144,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x517, addend: 0x1a9,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x53b, addend: 0x1b0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x546, addend: 0x219,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x567, addend: 0x20d,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x582, addend: 0xbb,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x589, addend: 0x230,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x597, addend: 0x6,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x59e, addend: 0x494,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x5a2, addend: 0x1cf,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x5ad, addend: 0x239,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x5b8, addend: 0x4f0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(8) } },
    X86_64Reloc::Abs32 { offset: 0x5bc, addend: 0x13,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs64 { offset: 0x5cb, addend: 0x262,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs64 { offset: 0x5d6, addend: 0x288,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x5e0, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x5eb, addend: 0x1c8,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } },
    X86_64Reloc::Abs32 { offset: 0x5f6, addend: 0x5a,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(13) } }
];


const RELA_DEBUG_FRAME_NUM_RELS: usize = 6;

const RELA_DEBUG_FRAME_RELS_CONTENTS_X86: [X86_64Reloc<SymData<&'static str,
                                                               u16, Elf64>>;
                                           RELA_DEBUG_FRAME_NUM_RELS] = [
    X86_64Reloc::Abs32 { offset: 0x1c, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(14) } },
    X86_64Reloc::Abs64 { offset: 0x20, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x4c, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(14) } },
    X86_64Reloc::Abs64 { offset: 0x50, addend: 0x110,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } },
    X86_64Reloc::Abs32 { offset: 0x84, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(14) } },
    X86_64Reloc::Abs64 { offset: 0x88, addend: 0x230,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } }
];

const RELA_DEBUG_LINE_NUM_RELS: usize = 1;

const RELA_DEBUG_LINE_RELS_CONTENTS_X86: [X86_64Reloc<SymData<&'static str, u16,
                                                              Elf64>>;
                                          RELA_DEBUG_LINE_NUM_RELS] = [
    X86_64Reloc::Abs64 { offset: 0x1b0, addend: 0,
                         sym: SymData { name: None, value: 0, size: 0,
                                        kind: SymKind::Section,
                                        bind: SymBind::Local,
                                        section: SymBase::Index(1) } }
];

pub const EXPECTED: [SectionHdrData<Elf64, &'static str,
                                    u32,
                                    SymsStrs<&'static [SymData<&'static str,
                                                               u16, Elf64>],
                                             &'static [(&'static str, usize)]>,
                                    &'static [(&'static str, usize)],
                                    SectionPos<u64>,
                                    &'static [SymData<&'static str,
                                                      u16, Elf64>],
                                    &'static [(&'static str, usize)],
                                    &'static [X86_64Reloc<SymData<&'static str,
                                                                  u16, Elf64>>],
                                    &'static [X86_64Reloc<SymData<&'static str,
                                                                  u16, Elf64>>],
                                    SectionPos<u64>,
                                    &'static [DynamicEntData<&'static str,
                                                             u64, Elf64>],
                                    &'static [NoteData<'static>]>;
                     NUM_SECTION_HDRS] = [
    SectionHdrData::Null,
    SectionHdrData::ProgBits { name: ".text", addr: 0, align: 16,
                               data: SectionPos { offset: 0x40,
                                                  size: 0x284 },
                               alloc: true, write: false, exec: true },
    SectionHdrData::Rela { name: ".rel.text", addr: 0, align: 8,
                           relas: &RELA_TEXT_FRAME_RELS_CONTENTS_X86,
                           symtab: SymsStrs { syms: &SYMTAB_CONTENTS,
                                              strs: &STRTAB_CONTENTS },
                           target: 1, alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".comment", addr: 0, align: 1,
                               data: SectionPos { offset: 0x394,
                                                  size: 0x279 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".rodata.str1.1", addr: 0, align: 1,
                               data: SectionPos { offset: 0x60d,
                                                  size: 0x1 },
                               alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".data", addr: 0, align: 8,
                               data: SectionPos { offset: 0x610,
                                                  size: 0x4 },
                               alloc: true, write: true, exec: false },
    SectionHdrData::Rela { name: ".rel.data", addr: 0, align: 8,
                           relas: &RELA_DATA_RELS_CONTENTS_X86,
                           symtab: SymsStrs { syms: &SYMTAB_CONTENTS,
                                              strs: &STRTAB_CONTENTS },
                           target: 5, alloc: false, write: false, exec: false },
    SectionHdrData::Nobits { name: ".bss", addr: 0, align: 8,
                             offset: 0x61c, size: 0x4, alloc: true,
                             write: true, exec: false },
    SectionHdrData::ProgBits { name: ".debug_loc", addr: 0, align: 1,
                               data: SectionPos { offset: 0x61c,
                                                  size: 0x295 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_abbrev", addr: 0, align: 1,
                               data: SectionPos { offset: 0x8b1,
                                                  size: 0x1f4 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_info", addr: 0, align: 1,
                               data: SectionPos { offset: 0xaa5,
                                                  size: 0x60b },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rel.debug_info", addr: 0, align: 8,
                           relas: &RELA_DEBUG_INFO_RELS_CONTENTS_X86,
                           symtab: SymsStrs { syms: &SYMTAB_CONTENTS,
                                              strs: &STRTAB_CONTENTS },
                           target: 10, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: ".debug_ranges", addr: 0, align: 1,
                               data: SectionPos { offset: 0x1488,
                                                  size: 0x30 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_str", addr: 0, align: 1,
                               data: SectionPos { offset: 0x14b8,
                                                  size: 0x2a1 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".debug_frame", addr: 0, align: 8,
                               data: SectionPos { offset: 0x175c,
                                                  size: 0x7c },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rel.debug_frame", addr: 0, align: 8,
                           relas: &RELA_DEBUG_FRAME_RELS_CONTENTS_X86,
                           symtab: SymsStrs { syms: &SYMTAB_CONTENTS,
                                              strs: &STRTAB_CONTENTS },
                           target: 14, alloc: false, write: false,
                           exec: false },
    SectionHdrData::ProgBits { name: ".debug_line", addr: 0, align: 1,
                               data: SectionPos { offset: 0x1808,
                                                  size: 0x46c },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Rela { name: ".rel.debug_line", addr: 0, align: 8,
                           relas: &RELA_DEBUG_LINE_RELS_CONTENTS_X86,
                           symtab: SymsStrs { syms: &SYMTAB_CONTENTS,
                                              strs: &STRTAB_CONTENTS },
                           target: 16, alloc: false, write: false,
                           exec: false },
    SectionHdrData::Unknown { name: ".llvm_addrsig", tag: 0x6fff4c03,
                              addr: 0, align: 1, offset: 0x1c84, size: 0xa,
                              ent_size: 0, link: 0, info: 0,
                              flags: 0x80000000 },
    SectionHdrData::Unknown { name: ".group", tag: 0x11, addr: 0,
                              align: 4, offset: 0x1cfc, size: 0x8,
                              ent_size: 4, link: 28, info: 72, flags: 0 },
    SectionHdrData::Note { name: ".note.tag", addr: 0, align: 4,
                           note: &NOTES1_CONTENTS,
                           alloc: true, write: false, exec: false },
    SectionHdrData::Note { name: ".note.tag", addr: 0, align: 4,
                           note: &NOTES2_CONTENTS,
                           alloc: true, write: false, exec: false },
    SectionHdrData::ProgBits { name: ".note.GNU-stack", addr: 0, align: 1,
                               data: SectionPos { offset: 0x1d4c,
                                                  size: 0x0 },
                               alloc: false, write: false, exec: false },
    SectionHdrData::Symtab { name: ".symtab", addr: 0, align: 8,
                             syms: &SYMTAB_CONTENTS,
                             strtab: &STRTAB_CONTENTS, local_end: 83,
                             alloc: false, write: false, exec: false },
    SectionHdrData::Strtab { name: ".shstrtab", addr: 0, align: 1,
                             strs: &SHSTRTAB_CONTENTS },
    SectionHdrData::Strtab { name: ".strtab", addr: 0, align: 1,
                             strs: &STRTAB_CONTENTS }
];
